geom_line(aes(group = Status, colour = Status)) +
ylim(0,100) +
theme_minimal() +
labs(x = NULL, y = "4-year graduation rate") +
facet_wrap(~ Category)
hsgrad_agg
hsgrad_agg <- ddply(hsgrad,.(School.Year, Category, Status), summarise,
mean = mean(X4.Year.Graduation..Rate, na.rm = TRUE),
median = median(X4.Year.Graduation..Rate, na.rm = TRUE))
#Show trends for region
ggplot(data = hsgrad_agg, aes(x = as.factor(School.Year), y = median)) +
geom_line(aes(group = Status, colour = Status)) +
ylim(0,100) +
theme_minimal() +
labs(x = NULL, y = "4-year graduation rate") +
facet_wrap(~ Category)
ggplot(data = hsgrad_agg, aes(x = as.factor(School.Year), y = mean)) +
geom_line(aes(group = Status, colour = Status)) +
ylim(0,100) +
theme_minimal() +
labs(x = NULL, y = "4-year graduation rate") +
facet_wrap(~ Category)
hsgrad_agg <- ddply(subset(hsgrad, X4.Year.Graduation..Rate > 0),
.(School.Year, Category, Status), summarise,
mean = mean(X4.Year.Graduation..Rate, na.rm = TRUE),
median = median(X4.Year.Graduation..Rate, na.rm = TRUE))
ggplot(data = hsgrad_agg, aes(x = as.factor(School.Year), y = mean)) +
geom_line(aes(group = Status, colour = Status)) +
ylim(0,100) +
theme_minimal() +
labs(x = NULL, y = "4-year graduation rate") +
facet_wrap(~ Category)
ggplot(data = hsgrad_agg) +
geom_line(aes(group = Status, colour = Status, x = as.factor(School.Year), y = mean)) +
geom_line(aes(group = Status, colour = Status, x = as.factor(School.Year), y = median)) +
ylim(0,100) +
theme_minimal() +
labs(x = NULL, y = "4-year graduation rate") +
facet_wrap(~ Category)
ggplot(data = hsgrad_agg) +
#  geom_line(aes(group = Status, colour = Status, x =as.factor(School.Year), y = mean)) +
geom_boxplot(aes(fill = Status, x =as.factor(School.Year), y = mean), stat ='identity') +
#  geom_line(aes(group = Status, colour = Status, x =as.factor(School.Year), y = median)) +
ylim(0,100) +
theme_minimal() +
labs(x = NULL, y = "4-year graduation rate") +
facet_wrap(~ Category)
ggplot(data = hsgrad_agg) +
#  geom_line(aes(group = Status, colour = Status, x =as.factor(School.Year), y = mean)) +
geom_boxplot(aes(fill = Status, x =as.factor(School.Year), y = mean,
ymin = `0%`, lower = `25%`, middle = `50%`, upper = `75%`, ymax = `100%`)), stat ='identity') +
#  geom_line(aes(group = Status, colour = Status, x =as.factor(School.Year), y = median)) +
ylim(0,100) +
theme_minimal() +
labs(x = NULL, y = "4-year graduation rate") +
facet_wrap(~ Category)
ggplot(data = hsgrad_agg) +
#  geom_line(aes(group = Status, colour = Status, x =as.factor(School.Year), y = mean)) +
geom_boxplot(aes(fill = Status, x =as.factor(School.Year), y = mean,
ymin = `0%`, lower = `25%`, middle = `50%`, upper = `75%`, ymax = `100%`)), stat ='identity') +
#  geom_line(aes(group = Status, colour = Status, x =as.factor(School.Year), y = median)) +
#  ylim(0,100) +
theme_minimal() +
labs(x = NULL, y = "4-year graduation rate") +
facet_wrap(~ Category)
ggplot(data = hsgrad_agg) +
#  geom_line(aes(group = Status, colour = Status, x =as.factor(School.Year), y = mean)) +
geom_boxplot(aes(fill = Status, x =as.factor(School.Year), y = mean,
ymin = `0%`, lower = `25%`, middle = `50%`, upper = `75%`, ymax = `100%`), stat ='identity') +
#  geom_line(aes(group = Status, colour = Status, x =as.factor(School.Year), y = median)) +
#  ylim(0,100) +
theme_minimal() +
labs(x = NULL, y = "4-year graduation rate") +
facet_wrap(~ Category)
ggplot(data = hsgrad_agg) +
#  geom_line(aes(group = Status, colour = Status, x =as.factor(School.Year), y = mean)) +
geom_boxplot(aes(fill = Status, x =as.factor(School.Year), y = mean,
ymin = '0%', lower = '25%', middle = '50%', upper = '75%', ymax = '100%'), stat ='identity') +
#  geom_line(aes(group = Status, colour = Status, x =as.factor(School.Year), y = median)) +
#  ylim(0,100) +
theme_minimal() +
labs(x = NULL, y = "4-year graduation rate") +
facet_wrap(~ Category)
#Show trends for region
ggplot(data = hsgrad_agg) +
#  geom_line(aes(group = Status, colour = Status, x =as.factor(School.Year), y = mean)) +
geom_boxplot(aes(x =as.factor(School.Year),
y = mean,
ymin = '0%',lower = '25%',middle = '50%',upper = '75%',ymax = '100%'), stat ='identity') +
#  geom_line(aes(group = Status, colour = Status, x =as.factor(School.Year), y = median)) +
#  ylim(0,100) +
theme_minimal() +
labs(x = NULL, y = "4-year graduation rate") +
facet_wrap(~ Category)
#Show trends for region
ggplot(data = hsgrad_agg) +
#  geom_line(aes(group = Status, colour = Status, x =as.factor(School.Year), y = mean)) +
geom_boxplot(aes(x =as.factor(School.Year),
y = mean,
ymin = '0%',lower = '25%',middle = '50%',upper = '75%',ymax = '100%'), stat ='identity') +
#  geom_line(aes(group = Status, colour = Status, x =as.factor(School.Year), y = median)) +
#  ylim(0,100) +
theme_minimal() +
labs(x = NULL, y = "4-year graduation rate")
ggplot(data = hsgrad_agg) +
#  geom_line(aes(group = Status, colour = Status, x =as.factor(School.Year), y = mean)) +
geom_boxplot(aes(x =as.factor(School.Year),
y =mean,
ymin = '0%',ymax = '100%'), stat ='identity') +
#  geom_line(aes(group = Status, colour = Status, x =as.factor(School.Year), y = median)) +
#  ylim(0,100) +
theme_minimal() +
labs(x = NULL, y = "4-year graduation rate") +
facet_wrap(~ Category)
ggplot(data = hsgrad_agg) +
#  geom_line(aes(group = Status, colour = Status, x =as.factor(School.Year), y = mean)) +
geom_boxplot(aes(x =as.factor(School.Year),
y =mean), stat ='identity') +
#  geom_line(aes(group = Status, colour = Status, x =as.factor(School.Year), y = median)) +
#  ylim(0,100) +
theme_minimal() +
labs(x = NULL, y = "4-year graduation rate") +
facet_wrap(~ Category)
#Show trends for region
ggplot(data = hsgrad_agg) +
#  geom_line(aes(group = Status, colour = Status, x =as.factor(School.Year), y = mean)) +
geom_boxplot(aes(x =as.factor(School.Year),
y =mean, ymin = '0%',lower = '25%',middle = '50%',upper = '75%',ymax = '100%'), stat ='identity') +
#  geom_line(aes(group = Status, colour = Status, x =as.factor(School.Year), y = median)) +
#  ylim(0,100) +
theme_minimal() +
labs(x = NULL, y = "4-year graduation rate") +
facet_wrap(~ Category)
ggplot(data = hsgrad_agg) +
#  geom_line(aes(group = Status, colour = Status, x =as.factor(School.Year), y = mean)) +
geom_boxplot(aes(x =as.factor(School.Year),
y =mean, ymin = '0%',lower = '25%',middle = '50%',upper = '75%',ymax = '100%')) +
#  geom_line(aes(group = Status, colour = Status, x =as.factor(School.Year), y = median)) +
#  ylim(0,100) +
theme_minimal() +
labs(x = NULL, y = "4-year graduation rate") +
facet_wrap(~ Category)
ggplot(data = hsgrad_agg) +
#  geom_line(aes(group = Status, colour = Status, x =as.factor(School.Year), y = mean)) +
geom_boxplot(aes(x =as.factor(School.Year),
y =mean, ymin = '0%',lower = '25%',middle = '50%',upper = '75%',ymax = '100%')) +
#  geom_line(aes(group = Status, colour = Status, x =as.factor(School.Year), y = median)) +
#  ylim(0,100) +
theme_minimal() +
labs(x = NULL, y = "4-year graduation rate")
ggplot(data = hsgrad_agg) +
#  geom_line(aes(group = Status, colour = Status, x =as.factor(School.Year), y = mean)) +
geom_boxplot(aes(x =as.factor(School.Year),
y =mean, ymin = '0%',lower = '25%',middle = '50%',upper = '75%',ymax = '100%')) +
#  geom_line(aes(group = Status, colour = Status, x =as.factor(School.Year), y = median)) +
#  ylim(0,100) +
theme_minimal()
ggplot(data = hsgrad_agg, aes(x =as.factor(School.Year), y =mean)) +
#  geom_line(aes(group = Status, colour = Status, x =as.factor(School.Year), y = mean)) +
geom_boxplot() +
#  geom_line(aes(group = Status, colour = Status, x =as.factor(School.Year), y = median)) +
#  ylim(0,100) +
theme_minimal() +
labs(x = NULL, y = "4-year graduation rate") +
facet_wrap(~ Category)
ggplot(data = hsgrad_agg, aes(x =as.factor(School.Year), y =mean)) +
#  geom_line(aes(group = Status, colour = Status, x =as.factor(School.Year), y = mean)) +
geom_boxplot() +
#  geom_line(aes(group = Status, colour = Status, x =as.factor(School.Year), y = median)) +
ylim(0,100) +
theme_minimal() +
labs(x = NULL, y = "4-year graduation rate") +
facet_wrap(~ Category)
ggplot(data = hsgrad_agg, aes(x =as.factor(School.Year), y =mean)) +
#  geom_line(aes(group = Status, colour = Status, x =as.factor(School.Year), y = mean)) +
geom_boxplot() +
#  geom_line(aes(group = Status, colour = Status, x =as.factor(School.Year), y = median)) +
ylim(0,100) +
theme_minimal() +
labs(x = NULL, y = "4-year graduation rate") +
facet_wrap(~ Category + Status)
ggplot(data = hsgrad_agg, aes(x =as.factor(School.Year), y =mean)) +
#  geom_line(aes(group = Status, colour = Status, x =as.factor(School.Year), y = mean)) +
geom_boxplot(aes(fill = Status)) +
#  geom_line(aes(group = Status, colour = Status, x =as.factor(School.Year), y = median)) +
ylim(0,100) +
theme_minimal() +
labs(x = NULL, y = "4-year graduation rate") +
facet_wrap(~ Category)
ggplot(data = hsgrad_agg, aes(x =as.factor(School.Year), y =mean)) +
#  geom_line(aes(group = Status, colour = Status, x =as.factor(School.Year), y = mean)) +
geom_boxplot(aes(group = Status)) +
#  geom_line(aes(group = Status, colour = Status, x =as.factor(School.Year), y = median)) +
ylim(0,100) +
theme_minimal() +
labs(x = NULL, y = "4-year graduation rate") +
facet_wrap(~ Category)
ggplot(data = hsgrad_agg, aes(x =as.factor(School.Year), y =mean)) +
#  geom_line(aes(group = Status, colour = Status, x =as.factor(School.Year), y = mean)) +
geom_boxplot(aes(group = Status), position = 'identity') +
#  geom_line(aes(group = Status, colour = Status, x =as.factor(School.Year), y = median)) +
ylim(0,100) +
theme_minimal() +
labs(x = NULL, y = "4-year graduation rate") +
facet_wrap(~ Category)
ggplot(data = hsgrad_agg, aes(x =as.factor(School.Year), y =mean)) +
#  geom_line(aes(group = Status, colour = Status, x =as.factor(School.Year), y = mean)) +
geom_boxplot(aes(group = Status), stat = 'identity') +
#  geom_line(aes(group = Status, colour = Status, x =as.factor(School.Year), y = median)) +
ylim(0,100) +
theme_minimal() +
labs(x = NULL, y = "4-year graduation rate") +
facet_wrap(~ Category)
ggplot(data = hsgrad_agg, aes(x =as.factor(School.Year), y =mean)) +
#  geom_line(aes(group = Status, colour = Status, x =as.factor(School.Year), y = mean)) +
geom_boxplot(aes(group = Status), position = 'identity') +
#  geom_line(aes(group = Status, colour = Status, x =as.factor(School.Year), y = median)) +
ylim(0,100) +
theme_minimal() +
labs(x = NULL, y = "4-year graduation rate") +
facet_wrap(~ Category)
#Show trends for region
ggplot(data = hsgrad_agg, aes(x =as.factor(School.Year), y =mean)) +
#  geom_line(aes(group = Status, colour = Status, x =as.factor(School.Year), y = mean)) +
geom_boxplot(aes(group = c(Status,School.Year), position = 'identity') +
#  geom_line(aes(group = Status, colour = Status, x =as.factor(School.Year), y = median)) +
ylim(0,100) +
theme_minimal() +
labs(x = NULL, y = "4-year graduation rate") +
facet_wrap(~ Category)
sad
ggplot(data = hsgrad_agg, aes(x =as.factor(School.Year), y =mean)) +
#  geom_line(aes(group = Status, colour = Status, x =as.factor(School.Year), y = mean)) +
geom_boxplot(aes(group = c(Status,School.Year)), position = 'identity') +
#  geom_line(aes(group = Status, colour = Status, x =as.factor(School.Year), y = median)) +
ylim(0,100) +
theme_minimal() +
labs(x = NULL, y = "4-year graduation rate") +
facet_wrap(~ Category)
ggplot(data = hsgrad_agg, aes(x =as.factor(School.Year), y =mean)) +
#  geom_line(aes(group = Status, colour = Status, x =as.factor(School.Year), y = mean)) +
geom_boxplot(aes(group = c(Status,as.factor(School.Year))), position = 'identity') +
#  geom_line(aes(group = Status, colour = Status, x =as.factor(School.Year), y = median)) +
ylim(0,100) +
theme_minimal() +
labs(x = NULL, y = "4-year graduation rate") +
facet_wrap(~ Category)
ggplot(data = hsgrad_agg, aes(x =as.factor(School.Year), y =mean)) +
#  geom_line(aes(group = Status, colour = Status, x =as.factor(School.Year), y = mean)) +
geom_boxplot(aes(group = Status), position = 'identity') +
#  geom_line(aes(group = Status, colour = Status, x =as.factor(School.Year), y = median)) +
ylim(0,100) +
theme_minimal() +
labs(x = NULL, y = "4-year graduation rate") +
facet_wrap(~ Category)
ggplot(data = hsgrad, aes(x =as.factor(School.Year), y =mean)) +
#  geom_line(aes(group = Status, colour = Status, x =as.factor(School.Year), y = mean)) +
geom_boxplot(aes(group = Status), position = 'identity') +
#  geom_line(aes(group = Status, colour = Status, x =as.factor(School.Year), y = median)) +
ylim(0,100) +
theme_minimal() +
labs(x = NULL, y = "4-year graduation rate") +
facet_wrap(~ Category)
ggplot(data = hsgrad, aes(x =as.factor(School.Year), y =X4.Year.Graduation..Rate)) +
#  geom_line(aes(group = Status, colour = Status, x =as.factor(School.Year), y = mean)) +
geom_boxplot(aes(group = Status), position = 'identity') +
#  geom_line(aes(group = Status, colour = Status, x =as.factor(School.Year), y = median)) +
ylim(0,100) +
theme_minimal() +
labs(x = NULL, y = "4-year graduation rate") +
facet_wrap(~ Category)
hsgrad <- read.csv("../hsgraduation/hsgraduationrates-school.csv",
na.strings = c("*","NA"))
#Filter to just regional districts
districts <- read.csv("../regionalreport/data/hartford-districts.csv")
hsgrad <- subset(hsgrad, hsgrad$District.Name %in% levels(districts$district))
hsgrad$District.Name <- factor(hsgrad$District.Name)
hsgrad_agg <- ddply(subset(hsgrad, X4.Year.Graduation..Rate > 0),
.(School.Year, Category, Status), summarise,
mean = mean(X4.Year.Graduation..Rate, na.rm = TRUE),
median = median(X4.Year.Graduation..Rate, na.rm = TRUE),
wm = weighted.mean(X4.Year.Graduation..Rate,
Estimated.Enrollment,na.rm = TRUE))
hsgrad <- read.csv("../hsgraduation/hsgraduationrates-school.csv",
na.strings = c("*","NA"))
names(hsgrad)
#Filter to just regional districts
districts <- read.csv("../regionalreport/data/hartford-districts.csv")
hsgrad <- subset(hsgrad, hsgrad$District.Name %in% levels(districts$district))
hsgrad$District.Name <- factor(hsgrad$District.Name)
hsgrad_agg <- ddply(subset(hsgrad, X4.Year.Graduation..Rate > 0),
.(School.Year, Category, Status), summarise,
mean = mean(X4.Year.Graduation..Rate, na.rm = TRUE),
median = median(X4.Year.Graduation..Rate, na.rm = TRUE),
wm = weighted.mean(X4.Year.Graduation..Rate,
Estimated.enrollment,na.rm = TRUE))
ggplot(data = hsgrad_agg, aes(x =as.factor(School.Year), y =wm)) +
geom_line(aes(group = Status, colour = Status, x =as.factor(School.Year), y = mean)) +
#  geom_boxplot(aes(group = Status), position = 'identity') +
#  geom_line(aes(group = Status, colour = Status, x =as.factor(School.Year), y = median)) +
ylim(0,100) +
theme_minimal() +
labs(x = NULL, y = "4-year graduation rate") +
facet_wrap(~ Category)
ggplot(data = hsgrad_agg, aes(x =as.factor(School.Year), y =wm)) +
geom_line(aes(group = Status, colour = Status, x =as.factor(School.Year), y = wm)) +
#  geom_boxplot(aes(group = Status), position = 'identity') +
#  geom_line(aes(group = Status, colour = Status, x =as.factor(School.Year), y = median)) +
ylim(0,100) +
theme_minimal() +
labs(x = NULL, y = "4-year graduation rate") +
facet_wrap(~ Category)
#Show trends for region
ggplot(data = hsgrad_agg, aes(x =as.factor(School.Year), y =wm)) +
geom_line(aes(group = Status, colour = Status)) +
#  geom_boxplot(aes(group = Status), position = 'identity') +
#  geom_line(aes(group = Status, colour = Status, x =as.factor(School.Year), y = median)) +
ylim(0,100) +
theme_minimal() +
labs(x = NULL, y = "4-year graduation rate") +
facet_wrap(~ Category)
hsgrad_agg
head(hsgrad_agg)
subset(hsgrad_agg, Category == "All Students")
ggplot(data = hsgrad_agg, aes(x =as.factor(School.Year), y =wm)) +
geom_line(aes(group = Status)) +
ylim(0,100) +
theme_minimal() +
labs(x = NULL, y = "4-year graduation rate") +
facet_wrap(~ Category)
ggplot(data = hsgrad_agg, aes(x =as.factor(School.Year), y =wm)) +
geom_line(aes(group = Status)) +
ylim(0,100) +
theme_minimal() +
labs(x = NULL, y = "4-year graduation rate") +
facet_wrap(~ Category, ncol = 6)
#Voting section
voting <- read.csv('../reviewversion/voting.csv')
#voting$Town <- gsub(pattern = " (CD1&2)", replacement = "", voting$Town)
voting <- subset(voting, voting$Town %in% levels(towns$Town))
vote <-
ggplot(data = ddply(merge(subset(voting, Type == "Municipal"),towns,by = "Town"),
.(Towngroup, Year), summarise,
Percentage.Checked.as.Having.Voted =
weighted.mean(Percentage.Checked.as.Having.Voted,
Names.on.Official.Check.List..Active.,na.rm = TRUE)),
aes(x = Year, y = Percentage.Checked.as.Having.Voted, group = Towngroup)) +
geom_line(aes(colour = Towngroup), size = 1) +
labs(x = NULL, y = "Percent of registered voters that voted",
title = "Voter turnout, municipal elections") +
scale_y_continuous(labels = percent, lim = c(0,.4)) +
theme_minimal()
ggplot(data = ddply(merge(subset(voting, Type == "Municipal"),towns,by = "Town"),
.(Towngroup, Year), summarise,
Percentage.Checked.as.Having.Voted =
weighted.mean(Percentage.Checked.as.Having.Voted,
Names.on.Official.Check.List..Active.,na.rm = TRUE)),
aes(x = Year, y = Percentage.Checked.as.Having.Voted, group = Towngroup)) +
geom_line(aes(colour = Towngroup), size = 1) +
labs(x = NULL, y = "Percent of registered voters that voted",
title = "Voter turnout, municipal elections") +
scale_y_continuous(labels = percent, lim = c(0,.4)) +
theme_minimal()
ggplot(data = ddply(merge(subset(voting, Type == "Municipal"),towns,by = "Town"),
.(Towngroup, Year), summarise,
Percentage.Checked.as.Having.Voted =
weighted.mean(Percentage.Checked.as.Having.Voted,
Names.on.Official.Check.List..Active.,na.rm = TRUE)),
aes(x = Year, y = Percentage.Checked.as.Having.Voted, group = Towngroup)) +
geom_line(aes(colour = Towngroup), size = 1) +
labs(x = NULL, y = "Percent of registered voters that voted",
title = "Voter turnout, municipal elections") +
scale_y_continuous(labels = percent, lim = c(0,.5)) +
theme_minimal()
ggplot(data = ddply(merge(subset(voting, Type == "Municipal"),towns,by = "Town"),
.(Towngroup, Year), summarise,
Percentage.Checked.as.Having.Voted =
weighted.mean(Percentage.Checked.as.Having.Voted,
Names.on.Official.Check.List..Active.,na.rm = TRUE)),
aes(x = Year, y = Percentage.Checked.as.Having.Voted, group = Towngroup)) +
geom_line(aes(colour = Towngroup), size = 1) +
labs(x = NULL, y = "Percent of registered voters that voted",
title = "Voter turnout, municipal elections") +
scale_y_continuous(labels = percent, lim = c(0,.6)) +
theme_minimal()
ggplot(data = ddply(merge(subset(voting, Type == "Municipal"),towns,by = "Town"),
.(Towngroup, Year), summarise,
Percentage.Checked.as.Having.Voted =
weighted.mean(Percentage.Checked.as.Having.Voted,
Names.on.Official.Check.List..Active.,na.rm = TRUE)),
aes(x = Year, y = Percentage.Checked.as.Having.Voted, group = Towngroup)) +
geom_line(aes(colour = Towngroup), size = 1) +
labs(x = NULL, y = "Percent of registered voters that voted",
title = "Voter turnout, municipal elections") +
scale_y_continuous(labels = percent, lim = c(0,1)) +
theme_minimal()
getwd()
head(qcew)
ggplot(data = qcew,
aes(x = value, y = year)) +
geom_line(aes(group = area)) +
theme_minimal(base_size = 16) +
labs(y = "Growth in employees (2003 - 2013)", y = NULL) +
scale_y_continuous(labels = comma) +
facet_wrap(~ sectortitle, ncol = 4)
ggplot(data = subset(qcew, series == "Employees" &
area == "North Central" &
naicsector < 100 &
year %in% c(2013, 2003)),
aes(x = value, y = year)) +
geom_line(aes(group = area)) +
theme_minimal(base_size = 16) +
labs(y = "Growth in employees (2003 - 2013)", y = NULL) +
scale_y_continuous(labels = comma) +
facet_wrap(~ sectortitle, ncol = 4)
ggplot(data = subset(qcew, series == "Employees" &
area == "North Central" &
naicsector < 100 &
year %in% c(2013, 2003)),
aes(y = value, x = year)) +
geom_line(aes(group = area)) +
theme_minimal(base_size = 16) +
labs(y = "Growth in employees (2003 - 2013)", y = NULL) +
scale_y_continuous(labels = comma) +
facet_wrap(~ sectortitle, ncol = 4)
ggplot(data = subset(qcew, series == "Employees" &
area == "North Central" &
naicsector < 100 &
sectortile != "Total - All Industries" &
year %in% c(2013, 2003)),
aes(y = value, x = year)) +
geom_line(aes(group = area)) +
theme_minimal(base_size = 16) +
labs(y = "Growth in employees (2003 - 2013)", y = NULL) +
scale_y_continuous(labels = comma) +
facet_wrap(~ sectortitle, ncol = 4)
ggplot(data = subset(qcew, series == "Employees" &
area == "North Central" &
naicsector < 100 &
sectortitle != "Total - All Industries" &
year %in% c(2013, 2003)),
aes(y = value, x = year)) +
geom_line(aes(group = area)) +
theme_minimal(base_size = 16) +
labs(y = "Growth in employees (2003 - 2013)", y = NULL) +
scale_y_continuous(labels = comma) +
facet_wrap(~ sectortitle, ncol = 4)
ggplot(data = subset(qcew, series == "Employees" &
area == "North Central" &
naicsector < 100 & sectortitle != "Total - All Industries"),
aes(y = value, x = year)) +
geom_line(aes(group = area)) +
theme_minimal(base_size = 16) +
labs(y = "Growth in employees (2003 - 2013)", y = NULL) +
scale_y_continuous(labels = comma) +
facet_wrap(~ sectortitle, ncol = 4)
jobgrowth
subset(jobgrowth, growth < -.1)
subset(jobgrowth, growth < -.1 & X2013 > 5000)
subset(jobgrowth, growth < -.1 & X2013 > 5000)[1]
ggplot(data = subset(qcew, series == "Employees" &
area == "North Central" &
sectortitle %in% c(subset(jobgrowth, growth < -.1 &
X2013 > 5000)[1])),
aes(y = value, x = year)) +
geom_line(aes(group = area)) +
theme_minimal(base_size = 16) +
labs(y = "Number of employees", y = NULL) +
scale_y_continuous(labels = comma) +
facet_wrap(~ sectortitle, ncol = 4)
subset(qcew, series == "Employees" &
area == "North Central" &
sectortitle %in% c(subset(jobgrowth, growth < -.1 &
X2013 > 5000)[1]))
c(subset(jobgrowth, growth < -.1 &
X2013 > 5000)[1]))
c(subset(jobgrowth, growth < -.1 &
X2013 > 5000)[1])
subset(qcew, series == "Employees" &
area == "North Central" &
sectortitle %in% subset(jobgrowth, growth < -.1 &
X2013 > 5000)[1])
subset(qcew, series == "Employees" &
area == "North Central" &
sectortitle %in% data.frame(subset(jobgrowth, growth < -.1 &
X2013 > 5000)[1]))
subset(qcew, series == "Employees" &
area == "North Central" &
sectortitle %in% as.data.frame(subset(jobgrowth, growth < -.1 &
X2013 > 5000)[1]))
subset(qcew, series == "Employees" &
area == "North Central" &
sectortitle %in% as.list(subset(jobgrowth, growth < -.1 &
X2013 > 5000)[1]))
subset(qcew, series == "Employees" &
area == "North Central" &
sectortitle %in% as.vector(subset(jobgrowth, growth < -.1 &
X2013 > 5000)[1]))
subset(qcew, series == "Employees" &
area == "North Central" &
sectortitle %in% as.table(subset(jobgrowth, growth < -.1 &
X2013 > 5000)[1]))
#Make the map
ggplot(data = choropleth, aes(long, lat, group = group)) +
geom_polygon(aes(fill = Towngroup)) +
scale_x_continuous(breaks = NULL) +
scale_y_continuous(breaks = NULL) +
labs(x = NULL, y = NULL) +
coord_equal() +
geom_polygon(data = CTTowns, colour = "grey", alpha = 0.5, fill = NA) +
scale_fill_brewer(palette = "Purples", name = "Types of towns") +
theme_minimal(base_size = 16)
